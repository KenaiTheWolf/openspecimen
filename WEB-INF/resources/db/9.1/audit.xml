<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
  http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

  <changeSet author="vpawar" id="Container display name chosen by the user">
    <addColumn tableName="OS_STORAGE_CONTAINERS_AUD">
      <column name="DISPLAY_NAME" type="${text.type}(255)" />
      <column name="displayName_MOD" type="${boolean.type}" />
    </addColumn>
  </changeSet>

  <changeSet author="vpawar" id="Visit level consents">
    <addColumn tableName="CAT_COLLECTION_PROTOCOL_AUD">
      <column name="VISIT_CONSENTS" type="${boolean.type}" />
      <column name="visitLevelConsents_MOD" type="${boolean.type}" />
    </addColumn>
  </changeSet>

  <changeSet author="vpawar" id="Form save/delete notification settings">
    <addColumn tableName="CATISSUE_FORM_CONTEXT_AUD">
      <column name="NOTIFS_ENABLED" type="${boolean.type}" />
      <column name="notifEnabled_MOD" type="${boolean.type}" />
      <column name="DATA_IN_NOTIF" type="${boolean.type}" />
      <column name="dataInNotif_MOD" type="${boolean.type}" />
      <column name="notifUserGroups_MOD" type="${boolean.type}" />
    </addColumn>
  </changeSet>

  <changeSet author="vpawar" id="Form save/delete notification user groups">
    <createTable tableName="OS_FORM_NOTIF_USER_GRPS_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="FORM_CTXT_ID" type="${int.type}" />
      <column name="USER_GROUP_ID" type="${int.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail of CP workflows">
    <createTable tableName="OS_CP_WORKFLOWS_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="CP_ID" type="${int.type}" />
      <column name="cp_MOD" type="${boolean.type}" />
      <column name="WORKFLOWS" type="${clob.type}" />
      <column name="workflowsJson_MOD" type="${boolean.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: CP consent tier collection">
    <addColumn tableName="CAT_COLLECTION_PROTOCOL_AUD">
      <column name="consentTier_MOD" type="${boolean.type}" />
    </addColumn>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: CP report settings">
    <createTable tableName="OS_CP_REPORT_SETTINGS_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="IDENTIFIER" type="${int.type}" />
      <column name="CP_ID" type="${int.type}" />
      <column name="cp_MOD" type="${boolean.type}" />
      <column name="ENABLED" type="${boolean.type}" />
      <column name="enabled_MOD" type="${boolean.type}" />
      <column name="DATA_QUERY_ID" type="${int.type}" />
      <column name="dataQuery_MOD" type="${boolean.type}" />
      <column name="CONFIG" type="${clob.type}" />
      <column name="configJson_MOD" type="${boolean.type}" />
      <column name="EMAIL_TMPL" type="${clob.type}" />
      <column name="emailTmpl_MOD" type="${boolean.type}" />
      <column name="ACTIVITY_STATUS" type="${text.type}(16)" />
      <column name="activityStatus_MOD" type="${boolean.type}" />
      <column name="recipients_MOD" type="${boolean.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: CP report email recipients">
    <createTable tableName="OS_CP_REPORT_RCPTS_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="REPORT_ID" type="${int.type}" />
      <column name="USER_ID" type="${int.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Change password update time field data type to timestamp">
    <modifyDataType tableName="CATISSUE_PASSWORD" columnName="UPDATE_DATE" newDataType="${timestamp.type}" />
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: Config settings">
    <createTable tableName="OS_CFG_SETTINGS_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="IDENTIFIER" type="${int.type}" />
      <column name="PROPERTY_ID" type="${int.type}" />
      <column name="property_MOD" type="${boolean.type}" />
      <column name="VALUE" type="${text.type}(255)" />
      <column name="value_MOD" type="${boolean.type}" />
      <column name="ACTIVATED_BY" type="${int.type}" />
      <column name="activatedBy_MOD" type="${boolean.type}" />
      <column name="ACTIVATION_DATE" type="${timestamp.type}" />
      <column name="activationDate_MOD" type="${boolean.type}" />
      <column name="ACTIVITY_STATUS" type="${text.type}(32)" />
      <column name="activityStatus_MOD" type="${boolean.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: print rules">
    <createTable tableName="OS_PRINT_RULES_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="IDENTIFIER" type="${int.type}" />
      <column name="DESCRIPTION" type="${text.type}(255)" />
      <column name="description_MOD" type="${boolean.type}" />
      <column name="OBJECT_TYPE" type="${text.type}(32)" />
      <column name="objectType_MOD" type="${boolean.type}" />
      <column name="INSTITUTE_ID" type="${int.type}" />
      <column name="institute_MOD" type="${boolean.type}" />
      <column name="UPDATED_BY" type="${int.type}" />
      <column name="updatedBy_MOD" type="${boolean.type}" />
      <column name="UPDATED_ON" type="${timestamp.type}" />
      <column name="updatedOn_MOD" type="${boolean.type}" />
      <column name="RULE_DEF" type="${clob.type}" />
      <column name="ruleDefJson_MOD" type="${boolean.type}" />
      <column name="ACTIVITY_STATUS" type="${text.type}(32)" />
      <column name="activityStatus_MOD" type="${boolean.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: DP consents modified or not">
    <addColumn tableName="CAT_DISTRIBUTION_PROTOCOL_AUD">
      <column name="consentTiers_MOD" type="${boolean.type}" />
    </addColumn>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: DP consents">
    <createTable tableName="OS_DP_CONSENT_TIERS_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="IDENTIFIER" type="${int.type}" />
      <column name="DP_ID" type="${int.type}" />
      <column name="distributionProtocol_MOD" type="${boolean.type}" />
      <column name="CONSENT_STMT_ID" type="${int.type}" />
      <column name="statement_MOD" type="${boolean.type}" />
      <column name="ACTIVITY_STATUS" type="${text.type}(16)" />
      <column name="activityStatus_MOD" type="${boolean.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: Scheduled jobs">
    <createTable tableName="OS_SCHEDULED_JOBS_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="IDENTIFIER" type="${int.type}" />
      <column name="NAME" type="${text.type}(255)" />
      <column name="name_MOD" type="${boolean.type}" />
      <column name="CREATED_BY" type="${int.type}" />
      <column name="createdBy_MOD" type="${boolean.type}" />
      <column name="START_DATE" type="${nullable.ts.type}" />
      <column name="startDate_MOD" type="${boolean.type}" />
      <column name="END_DATE" type="${nullable.ts.type}" />
      <column name="endDate_MOD" type="${boolean.type}" />
      <column name="HOURLY_INTERVAL" type="${smallint.type}" />
      <column name="hourlyInterval_MOD" type="${boolean.type}" />
      <column name="MINUTELY_INTERVAL" type="${smallint.type}" />
      <column name="minutelyInterval_MOD" type="${boolean.type}" />
      <column name="SCHEDULED_HOUR" type="${smallint.type}" />
      <column name="scheduledHour_MOD" type="${boolean.type}" />
      <column name="SCHEDULED_MINUTE" type="${smallint.type}" />
      <column name="scheduledMinute_MOD" type="${boolean.type}" />
      <column name="SCHEDULED_DAY_OF_WEEK" type="${text.type}(16)" />
      <column name="scheduledDayOfWeek_MOD" type="${boolean.type}" />
      <column name="SCHEDULED_DAY_OF_MONTH" type="${smallint.type}" />
      <column name="scheduledDayOfMonth_MOD" type="${boolean.type}" />
      <column name="ACTIVITY_STATUS" type="${text.type}(16)" />
      <column name="activityStatus_MOD" type="${boolean.type}" />
      <column name="REPEAT_SCHEDULE" type="${text.type}(16)" />
      <column name="repeatSchedule_MOD" type="${boolean.type}" />
      <column name="TYPE" type="${text.type}(16)" />
      <column name="type_MOD" type="${boolean.type}" />
      <column name="COMMAND" type="${text.type}(255)" />
      <column name="command_MOD" type="${boolean.type}" />
      <column name="FIXED_ARGS" type="${clob.type}" />
      <column name="fixedArgs_MOD" type="${boolean.type}" />
      <column name="TASK_IMPL_FQN" type="${text.type}(255)" />
      <column name="taskImplfqn_MOD" type="${boolean.type}" />
      <column name="QUERY_ID" type="${int.type}" />
      <column name="savedQuery_MOD" type="${boolean.type}" />
      <column name="RUN_AS_USER_ID" type="${int.type}" />
      <column name="runAs_MOD" type="${boolean.type}" />
      <column name="RT_ARGS_PROVIDED" type="${boolean.type}" />
      <column name="rtArgsProvided_MOD" type="${boolean.type}" />
      <column name="RT_ARGS_HELP_TEXT" type="${text.type}(255)" />
      <column name="rtArgsHelpText_MOD" type="${boolean.type}" />
      <column name="recipients_MOD" type="${boolean.type}" />
      <column name="sharedWith_MOD" type="${boolean.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: Job run status notification recipients">
    <createTable tableName="OS_SCHED_JOBS_NOTIF_RCPTS_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="SCHEDULED_JOB_ID" type="${int.type}" />
      <column name="USER_ID" type="${int.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: Users with whom the scheduled job is shared">
    <createTable tableName="OS_SCHED_JOB_SHARED_USERS_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="SCHEDULED_JOB_ID" type="${int.type}" />
      <column name="USER_ID" type="${int.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: User groups">
    <createTable tableName="OS_USER_GROUPS_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="IDENTIFIER" type="${int.type}" />
      <column name="NAME" type="${text.type}(64)" />
      <column name="name_MOD" type="${boolean.type}" />
      <column name="DESCRIPTION" type="${text.type}(255)" />
      <column name="description_MOD" type="${boolean.type}" />
      <column name="INSTITUTE_ID" type="${int.type}" />
      <column name="institute_MOD" type="${boolean.type}" />
      <column name="ACTIVITY_STATUS" type="${text.type}(32)" />
      <column name="activityStatus_MOD" type="${boolean.type}" />
      <column name="users_MOD" type="${boolean.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: User group users">
    <createTable tableName="OS_USER_GROUP_USERS_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="GROUP_ID" type="${int.type}" />
      <column name="USER_ID" type="${int.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: Saved queries">
    <createTable tableName="CATISSUE_SAVED_QUERIES_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="IDENTIFIER" type="${int.type}" />
      <column name="TITLE" type="${text.type}(128)" />
      <column name="title_MOD" type="${boolean.type}" />
      <column name="CP_ID" type="${int.type}" />
      <column name="cpId_MOD" type="${boolean.type}" />
      <column name="CP_GROUP_ID" type="${int.type}" />
      <column name="cpGroupId_MOD" type="${boolean.type}" />
      <column name="QUERY_DEF" type="${clob.type}" />
      <column name="queryDefJson_MOD" type="${boolean.type}" />
      <column name="DELETED_ON" type="${nullable.ts.type}" />
      <column name="deletedOn_MOD" type="${boolean.type}" />
      <column name="subQueries_MOD" type="${boolean.type}" />
      <column name="dependentQueries_MOD" type="${boolean.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: Saved query - sub queries">
    <createTable tableName="OS_SAVED_QUERY_DEPS_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="QUERY_ID" type="${int.type}" />
      <column name="SUB_QUERY_ID" type="${int.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: Query folders">
    <createTable tableName="CATISSUE_QUERY_FOLDERS_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="IDENTIFIER" type="${int.type}" />
      <column name="NAME" type="${text.type}(64)" />
      <column name="name_MOD" type="${boolean.type}" />
      <column name="OWNER" type="${int.type}" />
      <column name="owner_MOD" type="${boolean.type}" />
      <column name="SHARED_WITH_ALL" type="${boolean.type}" />
      <column name="sharedWithAll_MOD" type="${boolean.type}" />
      <column name="sharedWith_MOD" type="${boolean.type}" />
      <column name="sharedWithGroups_MOD" type="${boolean.type}" />
      <column name="savedQueries_MOD" type="${boolean.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: Query folder users">
    <createTable tableName="OS_QUERY_FOLDER_USERS_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="FOLDER_ID" type="${int.type}" />
      <column name="USER_ID" type="${int.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: Query folder user groups">
    <createTable tableName="OS_QUERY_FOLDER_USER_GRPS_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="FOLDER_ID" type="${int.type}" />
      <column name="GROUP_ID" type="${int.type}" />
    </createTable>
  </changeSet>

  <changeSet author="vpawar" id="Audit trail: Query folder queries">
    <createTable tableName="OS_QUERY_FOLDER_QUERIES_AUD">
      <column name="REV" type="${int.type}" />
      <column name="REVTYPE" type="${tinyint.type}" />
      <column name="FOLDER_ID" type="${int.type}" />
      <column name="QUERY_ID" type="${int.type}" />
    </createTable>
  </changeSet>
</databaseChangeLog>
